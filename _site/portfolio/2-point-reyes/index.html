<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Point Reyes, CA</title>
  <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>
  <div class="wrapper">
    <aside class="left-sidebar">
      <!-- Left sidebar content -->
    </aside>

    <div class="main-content">
      <header>
    <div class="logo">
        <a href="/">
            <h1>Nathan Duggins</h1>
        </a>
    </div>
    <nav>
        
            <a href="/" >
                Resume
            </a>
        
            <a href="/portfolio/" >
                Portfolio
            </a>
        
            <a href="/contact/" >
                Contact
            </a>
        
    </nav>
</header>

      <main>
        <article class="portfolio-item-page">
  <div class="portfolio-description">
    <h1>Point Reyes, CA</h1>
    <p>This innovative mapping project at Point Reyes National Seashore showcases the cutting-edge application of unmanned 
aerial vehicle (UAV) 
technology and multispectral sensors in coastal ecosystem monitoring. Focusing on four distinct beaches within 
this protected California landscape, our team leveraged advanced remote sensing techniques to create<br />
high-resolution maps of these dynamic intertidal zones.</p>

<p>Our methodology combined precision UAV flights, timed with the lowest tides, and accurate ground control points to 
produce high-accuracy, high-resolution orthophotos and elevation models. The integration of multispectral imagery 
allowed us to differentiate between visually similar surface types, such as mussels and algae - crucial indicators of 
ecosystem health. Using supervised classification algorithms, we developed comprehensive maps of species distribution 
across these complex coastal environments.</p>

<p>Check out the storymap for more details, pretty pictures, and cool maps.</p>

  </div>

  <div class="portfolio-image">
    <img src="/assets/images/portfolio/SlideStorymapCover.jpg" alt="Point Reyes, CA" id="zoomable-image" style="cursor: pointer;">
  </div>
</article>

<div id="image-popup" class="popup">
  <span class="close-btn">&times;</span>
  <canvas id="popup-canvas"></canvas>
</div>

<style>
  .popup {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background-color: rgba(0,0,0,0.9);
  }
  #popup-canvas {
    display: block;
    margin: auto;
  }
  .close-btn {
    position: absolute;
    top: 15px;
    right: 35px;
    color: #f1f1f1;
    font-size: 40px;
    font-weight: bold;
    cursor: pointer;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const img = document.getElementById('zoomable-image');
  const popup = document.getElementById('image-popup');
  const canvas = document.getElementById('popup-canvas');
  const ctx = canvas.getContext('2d');
  const closeBtn = document.querySelector('.close-btn');
  const storymapUrl = 'https://storymaps.arcgis.com/stories/a2265baddeef4e33829617c9d7542329';

  const view = (() => {
    const matrix = [1, 0, 0, 1, 0, 0];
    let m = matrix;
    let scale = 1;
    let ctx;
    const pos = { x: 0, y: 0 };
    let dirty = true;
    const API = {
      set context(_ctx) { ctx = _ctx; dirty = true },
      apply() {
        if (dirty) { this.update() }
        ctx.setTransform(m[0], m[1], m[2], m[3], m[4], m[5])
      },
      get scale() { return scale },
      get position() { return pos },
      isDirty() { return dirty },
      update() {
        dirty = false;
        m[3] = m[0] = scale;
        m[2] = m[1] = 0;
        m[4] = pos.x;
        m[5] = pos.y;
      },
      pan(amount) {
        if (dirty) { this.update() }
        pos.x += amount.x;
        pos.y += amount.y;
        dirty = true;
      },
      scaleAt(at, amount) {
        if (dirty) { this.update() }
        scale *= amount;
        pos.x = at.x - (at.x - pos.x) * amount;
        pos.y = at.y - (at.y - pos.y) * amount;
        dirty = true;
      },
      reset() {
        scale = 1;
        pos.x = 0;
        pos.y = 0;
        dirty = true;
      },
      fitToExtent(imgWidth, imgHeight, canvasWidth, canvasHeight) {
        const scaleX = canvasWidth / imgWidth;
        const scaleY = canvasHeight / imgHeight;
        scale = Math.min(scaleX, scaleY);
        pos.x = (canvasWidth - imgWidth * scale) / 2;
        pos.y = (canvasHeight - imgHeight * scale) / 2;
        dirty = true;
      }
    };
    return API;
  })();

  function fitImageToCanvas() {
    const canvasWidth = window.innerWidth;
    const canvasHeight = window.innerHeight;
    canvas.width = canvasWidth;
    canvas.height = canvasHeight;
    view.fitToExtent(img.naturalWidth, img.naturalHeight, canvasWidth, canvasHeight);
  }

  img.onclick = function() {
    if (storymapUrl) {
      window.open(storymapUrl, '_blank', 'noopener,noreferrer');
    } else {
      popup.style.display = 'block';
      view.context = ctx;
      fitImageToCanvas();
      drawCanvas();
    }
  }

  closeBtn.onclick = function() {
    popup.style.display = 'none';
  }

  function drawCanvas() {
    if (view.isDirty()) {
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      view.apply();
      ctx.drawImage(img, 0, 0);
    }
    requestAnimationFrame(drawCanvas);
  }

  canvas.addEventListener("mousemove", mouseEvent, {passive: true});
  canvas.addEventListener("mousedown", mouseEvent, {passive: true});
  canvas.addEventListener("mouseup", mouseEvent, {passive: true});
  canvas.addEventListener("mouseout", mouseEvent, {passive: true});
  canvas.addEventListener("wheel", mouseWheelEvent, {passive: false});

  const mouse = {x: 0, y: 0, oldX: 0, oldY: 0, button: false};

  function mouseEvent(event) {
    if (event.type === "mousedown") { mouse.button = true }
    if (event.type === "mouseup" || event.type === "mouseout") { mouse.button = false }
    mouse.oldX = mouse.x;
    mouse.oldY = mouse.y;
    mouse.x = event.offsetX;
    mouse.y = event.offsetY
    if(mouse.button) {
      view.pan({x: mouse.x - mouse.oldX, y: mouse.y - mouse.oldY});
    }
  }

  function mouseWheelEvent(event) {
    const x = event.offsetX;
    const y = event.offsetY;
    if (event.deltaY < 0) {
      view.scaleAt({x, y}, 1.1);
    } else {
      view.scaleAt({x, y}, 1 / 1.1);
    }
    event.preventDefault();
  }

  window.addEventListener('resize', function() {
    if (popup.style.display === 'block') {
      fitImageToCanvas();
    }
  });
});
</script>
      </main>
    </div>

    <aside class="right-sidebar">
      <!-- Right sidebar content -->
    </aside>
  </div>
</body>
</html>